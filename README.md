# Discord ä¼ºæœå™¨çµ±è¨ˆèˆ‡å¯è¦–åŒ– Embedded App

å®Œæ•´çš„ Discord Embedded Appï¼Œæä¾›ä¼ºæœå™¨çµ±è¨ˆã€æˆå“¡æ´»å‹•åˆ†æã€æ­·å²è¨Šæ¯æå–ç­‰åŠŸèƒ½ã€‚æ”¯æ´ç°¡ç¹é«”ä¸­æ–‡åˆ‡æ›ã€‚

## âœ¨ åŠŸèƒ½ç‰¹è‰²

### ğŸ“Š çµ±è¨ˆèˆ‡åˆ†æ
- **å³æ™‚çµ±è¨ˆ**ï¼šä¼ºæœå™¨æ¦‚è¦½ã€æˆå“¡æ•¸ã€é »é“æ•¸ã€è§’è‰²æ•¸
- **è¶¨å‹¢åˆ†æ**ï¼šå¯è‡ªè¨‚æ™‚é–“ç¯„åœï¼ˆ7å¤©/30å¤©/90å¤©/180å¤©/ä¸€å¹´/æ‰€æœ‰æ™‚é–“ï¼‰çš„è¨Šæ¯é‡å’Œæ´»èºç”¨æˆ¶è¶¨å‹¢åœ–è¡¨
- **é »é“åˆ†æ**ï¼šå„é »é“ä½¿ç”¨ç‡çµ±è¨ˆå’Œæ’è¡Œ
- **æˆå“¡æ’è¡Œ**ï¼šæ´»èºåº¦æ’è¡Œæ¦œï¼ˆTop 10ï¼‰
- **è¡¨æƒ…çµ±è¨ˆ**ï¼šè‡ªè¨‚å’Œ Unicode è¡¨æƒ…ä½¿ç”¨æ’åï¼Œæ”¯æ´å‹•ç•« emoji

### ğŸ”§ ç®¡ç†å“¡åŠŸèƒ½
- **æ­·å²è¨Šæ¯æå–**ï¼šæ‰¹é‡æå–é »é“æ­·å²è¨Šæ¯
- **æ™ºèƒ½åˆ†æ**ï¼šè‡ªå‹•è­˜åˆ¥éœ€è¦æ›´æ–°çš„é »é“
- **è¨è«–ä¸²æ”¯æ´**ï¼šå®Œæ•´æ”¯æ´ Discord è¨è«–ä¸²ï¼ˆthreadsï¼‰å’Œè«–å£‡é »é“
- **é€²åº¦è¿½è¹¤**ï¼šå³æ™‚æŸ¥çœ‹æå–ä»»å‹™é€²åº¦å’Œæ­·å²è¨˜éŒ„
- **æ¬Šé™ç®¡ç†**ï¼šåŸºæ–¼è³‡æ–™åº«çš„ç®¡ç†å“¡æ¬Šé™ç³»çµ±

### ğŸ¨ ç”¨æˆ¶é«”é©—
- **ç¾ä»£åŒ– UI**ï¼šä½¿ç”¨ shadcn/ui å’Œ Tailwind CSS v4
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼šå®Œç¾é©é…æ¡Œé¢å’Œæ‰‹æ©Ÿ
- **ç°¡ç¹é«”åˆ‡æ›**ï¼šæ”¯æ´ç¹é«”ä¸­æ–‡å’Œç°¡é«”ä¸­æ–‡
- **æ·±è‰²ä¸»é¡Œ**ï¼šè­·çœ¼çš„æ·±è‰²é…è‰²æ–¹æ¡ˆ
- **éŒ¯èª¤è™•ç†**ï¼šå‹å¥½çš„éŒ¯èª¤æç¤ºå’Œå¾Œå‚™æ–¹æ¡ˆ

## æŠ€è¡“æ¶æ§‹

### å‰ç«¯ (client/)
- Next.js 16 + App Router
- React 19 + TypeScript (strict mode)
- shadcn/ui + Tailwind CSS v4
- Recharts æ•¸æ“šå¯è¦–åŒ–
- Discord Embedded App SDK

### å¾Œç«¯ (server/)
- Node.js + Express
- PostgreSQL è³‡æ–™åº«
- RESTful API

### Bot (bot/)
- Discord.js v14
- å³æ™‚è¨Šæ¯æ”¶é›†
- æ­·å²è¨Šæ¯æå–
- æ¯æ—¥çµ±è¨ˆèšåˆ

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³•ä¸€ï¼šä¸€éµéƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰

```bash
# 1. å…‹éš†å°ˆæ¡ˆ
git clone <your-repo-url>
cd discord-embed-app

# 2. é…ç½®ç’°å¢ƒè®Šæ•¸
cp .env.example .env
cp bot/.env.example bot/.env
cp client/.env.example client/.env.local
# ç·¨è¼¯é€™äº›æ–‡ä»¶ä¸¦å¡«å…¥æ­£ç¢ºçš„å€¼

# 3. åŸ·è¡Œä¸€éµéƒ¨ç½²
./deploy.sh
```

éƒ¨ç½²è…³æœ¬æœƒè‡ªå‹•ï¼š
- âœ… æª¢æŸ¥ç’°å¢ƒå’Œä¾è³´
- âœ… å®‰è£æ‰€æœ‰ npm å¥—ä»¶
- âœ… è¨­ç½®è³‡æ–™åº«
- âœ… æ§‹å»ºå‰ç«¯
- âœ… ä½¿ç”¨ PM2 å•Ÿå‹•æ‰€æœ‰æœå‹™

### æ–¹æ³•äºŒï¼šæ‰‹å‹•è¨­ç½®

#### 1. ç’°å¢ƒéœ€æ±‚

- Node.js 18+
- PostgreSQL 14+
- Discord Bot Token
- Discord Application (Embedded App)
- PM2ï¼ˆå¯é¸ï¼Œç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒï¼‰

#### 2. å®‰è£ä¾è³´

```bash
# å®‰è£æ‰€æœ‰ä¾è³´
npm install
cd client && npm install && cd ..
cd bot && npm install && cd ..
```

#### 3. é…ç½®ç’°å¢ƒè®Šæ•¸

è¤‡è£½ä¸¦ç·¨è¼¯ç’°å¢ƒè®Šæ•¸æ–‡ä»¶ï¼š

```bash
# æ ¹ç›®éŒ„ .env
cp .env.example .env

# Bot .env
cp bot/.env.example bot/.env

# Client .env.local
cp client/.env.example client/.env.local
```

è©³ç´°é…ç½®èªªæ˜è«‹åƒè€ƒ [CONFIGURATION.md](CONFIGURATION.md)

#### 4. åˆå§‹åŒ–è³‡æ–™åº«

```bash
# å‰µå»ºè³‡æ–™åº«
createdb discord_stats

# åŸ·è¡Œæ¶æ§‹è…³æœ¬
psql -U postgres -d discord_stats -f bot/database/schema.sql

# æ·»åŠ è¨è«–ä¸²æ”¯æ´
psql -U postgres -d discord_stats -f bot/database/add_thread_support.sql

# æ·»åŠ é™„ä»¶æ”¯æ´
psql -U postgres -d discord_stats -f bot/database/add_attachments.sql
```

#### 5. å•Ÿå‹•æœå‹™

**é–‹ç™¼æ¨¡å¼ï¼š**
```bash
npm run dev
```

**ç”Ÿç”¢æ¨¡å¼ï¼š**
```bash
# æ§‹å»ºå‰ç«¯
cd client && npm run build && cd ..

# ä½¿ç”¨ PM2 å•Ÿå‹•
pm2 start ecosystem.config.js

# æˆ–ä½¿ç”¨ç®¡ç†è…³æœ¬
./manage.sh start
```

æœå‹™å°‡é‹è¡Œåœ¨ï¼š
- Server: http://localhost:3008
- Client: http://localhost:3000
- Bot: è‡ªå‹•å•Ÿå‹•

## ğŸ“š æ–‡æª”

### æ ¸å¿ƒæ–‡æª”
- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT_GUIDE.md) - **å®Œæ•´çš„éƒ¨ç½²å’Œç®¡ç†æŒ‡å—**
- [é…ç½®æŒ‡å—](CONFIGURATION.md) - ç’°å¢ƒè®Šæ•¸å’Œé…ç½®èªªæ˜
- [é–‹ç™¼æŒ‡å—](DEVELOPMENT.md) - é–‹ç™¼ç’°å¢ƒè¨­ç½®å’Œå¸¸ç”¨å‘½ä»¤

### åŠŸèƒ½æ–‡æª”
- [æ­·å²æå–æŒ‡å—](HISTORY_FETCH_GUIDE.md) - æ­·å²è¨Šæ¯æå–åŠŸèƒ½ä½¿ç”¨èªªæ˜
- [è¨è«–ä¸²æ”¯æ´](docs/THREAD_SUPPORT.md) - Discord è¨è«–ä¸²åŠŸèƒ½èªªæ˜
- [è³‡æ–™åº«æ¶æ§‹](bot/database/README.md) - è³‡æ–™åº«è¡¨çµæ§‹èªªæ˜

### å•é¡Œä¿®å¾©
- [Emoji ä¿®å¾©](EMOJI_FIX.md) - Emoji åœ–ç‰‡é¡¯ç¤ºå•é¡Œä¿®å¾©
- [å°èˆªä¿®å¾©](NAVIGATION_FIX.md) - é é¢å°èˆªå•é¡Œä¿®å¾©
- [æ•…éšœæ’é™¤](TROUBLESHOOTING.md) - å¸¸è¦‹å•é¡Œè§£æ±ºæ–¹æ¡ˆ

## å°ˆæ¡ˆçµæ§‹

```
discord-embed-app/
â”œâ”€â”€ bot/                    # Discord Bot
â”‚   â”œâ”€â”€ database/          # è³‡æ–™åº«æ¶æ§‹
â”‚   â”œâ”€â”€ handlers/          # è¨Šæ¯å’Œæ­·å²æå–è™•ç†
â”‚   â”œâ”€â”€ jobs/              # å®šæ™‚ä»»å‹™
â”‚   â””â”€â”€ commands/          # Bot å‘½ä»¤
â”œâ”€â”€ server/                # Express API
â”‚   â”œâ”€â”€ controllers/       # æ¥­å‹™é‚è¼¯
â”‚   â”œâ”€â”€ routes/           # API è·¯ç”±
â”‚   â””â”€â”€ middleware/       # ä¸­é–“ä»¶
â”œâ”€â”€ client/               # Next.js å‰ç«¯
â”‚   â”œâ”€â”€ app/             # App Router é é¢
â”‚   â”œâ”€â”€ components/      # React çµ„ä»¶
â”‚   â”œâ”€â”€ lib/             # å·¥å…·å‡½æ•¸
â”‚   â””â”€â”€ types/           # TypeScript é¡å‹
â””â”€â”€ docs/                # æ–‡æª”
```

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### éƒ¨ç½²è…³æœ¬

```bash
# ä¸€éµéƒ¨ç½²
./deploy.sh              # å®Œæ•´éƒ¨ç½²ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰

# å¿«é€Ÿæ›´æ–°
./update.sh              # æ›´æ–°ä»£ç¢¼ã€ä¾è³´ã€é‡æ–°æ§‹å»ºå’Œé‡å•Ÿ

# æ—¥å¸¸ç®¡ç†
./manage.sh start        # å•Ÿå‹•æ‰€æœ‰æœå‹™
./manage.sh stop         # åœæ­¢æ‰€æœ‰æœå‹™
./manage.sh restart      # é‡å•Ÿæ‰€æœ‰æœå‹™
./manage.sh status       # æŸ¥çœ‹æœå‹™ç‹€æ…‹
./manage.sh logs         # æŸ¥çœ‹æ‰€æœ‰æ—¥èªŒ
./manage.sh logs-api     # æŸ¥çœ‹ API æ—¥èªŒ
./manage.sh logs-bot     # æŸ¥çœ‹ Bot æ—¥èªŒ
./manage.sh logs-client  # æŸ¥çœ‹ Client æ—¥èªŒ
./manage.sh backup       # å‚™ä»½è³‡æ–™åº«
./manage.sh restore <file> # é‚„åŸè³‡æ–™åº«
./manage.sh health       # å¥åº·æª¢æŸ¥
./manage.sh clean        # æ¸…ç†æ—¥èªŒå’ŒèˆŠå‚™ä»½
```

### NPM è…³æœ¬

```bash
# é–‹ç™¼
npm run dev              # å•Ÿå‹•æ‰€æœ‰æœå‹™ï¼ˆæ¨è–¦ï¼‰
npm run server           # åªå•Ÿå‹• serverï¼ˆåŒ…å« botï¼‰
npm run client           # åªå•Ÿå‹• client
npm run bot              # åªå•Ÿå‹• bot

# ç”Ÿç”¢
npm run build            # æ§‹å»ºå‰ç«¯
npm start                # å•Ÿå‹•ç”Ÿç”¢æœå‹™å™¨
npm run start:bot        # å•Ÿå‹• bot
```

### PM2 å‘½ä»¤

```bash
pm2 status               # æŸ¥çœ‹æ‰€æœ‰æœå‹™ç‹€æ…‹
pm2 logs                 # æŸ¥çœ‹æ‰€æœ‰æ—¥èªŒ
pm2 logs discord-api     # æŸ¥çœ‹ç‰¹å®šæœå‹™æ—¥èªŒ
pm2 restart all          # é‡å•Ÿæ‰€æœ‰æœå‹™
pm2 stop all             # åœæ­¢æ‰€æœ‰æœå‹™
pm2 monit                # ç›£æ§é¢æ¿
```

## ğŸ” ç®¡ç†å“¡åŠŸèƒ½

è¨ªå• `/admin` é é¢ä½¿ç”¨æ­·å²è¨Šæ¯æå–åŠŸèƒ½ï¼š

### åŠŸèƒ½åˆ—è¡¨

1. **æ‰¹é‡æå–**
   - æ™ºèƒ½è­˜åˆ¥éœ€è¦æ›´æ–°çš„é »é“
   - ä¸€éµæ‰¹é‡æå–å¤šå€‹é »é“
   - æ”¯æ´è¨è«–ä¸²å’Œè«–å£‡é »é“
   - å³æ™‚é€²åº¦é¡¯ç¤º

2. **é »é“ç®¡ç†**
   - æŸ¥çœ‹æ‰€æœ‰é »é“å’Œè¨è«–ä¸²
   - é¡¯ç¤ºæå–ç‹€æ…‹å’Œçµ±è¨ˆ
   - å–®ç¨æå–ç‰¹å®šé »é“

3. **æå–æ­·å²**
   - æŸ¥çœ‹æ‰€æœ‰æå–ä»»å‹™
   - å³æ™‚é€²åº¦è¿½è¹¤
   - è©³ç´°çš„çµ±è¨ˆä¿¡æ¯
   - éŒ¯èª¤æ—¥èªŒæŸ¥çœ‹

### æ¬Šé™ç®¡ç†

ç®¡ç†å“¡æ¬Šé™åŸºæ–¼è³‡æ–™åº« `admin_users` è¡¨ï¼š

```sql
-- æ·»åŠ ç®¡ç†å“¡
INSERT INTO admin_users (guild_id, user_id, username) 
VALUES ('your_guild_id', 'user_id', 'username');

-- æŸ¥çœ‹ç®¡ç†å“¡
SELECT * FROM admin_users WHERE guild_id = 'your_guild_id';

-- ç§»é™¤ç®¡ç†å“¡
DELETE FROM admin_users 
WHERE guild_id = 'your_guild_id' AND user_id = 'user_id';
```

åŒä¸€å€‹ç”¨æˆ¶å¯ä»¥åœ¨å¤šå€‹ä¼ºæœå™¨æ“æœ‰ç®¡ç†å“¡æ¬Šé™ï¼Œæ¬Šé™æ˜¯æŒ‰ä¼ºæœå™¨ç¨ç«‹ç®¡ç†çš„ã€‚

## ğŸŒŸ æœ€æ–°æ›´æ–°

### v2.0.0 (2024)

- âœ… **ç°¡ç¹é«”ä¸­æ–‡åˆ‡æ›**ï¼šå®Œæ•´çš„åœ‹éš›åŒ–æ”¯æ´
- âœ… **è¨è«–ä¸²æ”¯æ´**ï¼šå®Œæ•´æ”¯æ´ Discord è¨è«–ä¸²å’Œè«–å£‡é »é“
- âœ… **é™„ä»¶æ”¯æ´**ï¼šè¨˜éŒ„è¨Šæ¯ä¸­çš„åœ–ç‰‡å’Œæ–‡ä»¶é™„ä»¶
- âœ… **æ™‚é–“ç¯„åœé¸æ“‡**ï¼šå¯è‡ªè¨‚çµ±è¨ˆæ™‚é–“ç¯„åœï¼ˆ7å¤©åˆ°æ‰€æœ‰æ™‚é–“ï¼‰
- âœ… **Emoji å„ªåŒ–**ï¼šä¿®å¾©è‡ªå®šç¾© emoji é¡¯ç¤ºå•é¡Œï¼Œæ”¯æ´å‹•ç•« emoji
- âœ… **å°èˆªå„ªåŒ–**ï¼šä½¿ç”¨ Next.js å®¢æˆ¶ç«¯è·¯ç”±ï¼Œé¿å…é é¢é‡è¼‰
- âœ… **éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼šå®Œç¾é©é…æ‰‹æ©Ÿå’Œå¹³æ¿
- âœ… **ä¸€éµéƒ¨ç½²**ï¼šæä¾›å®Œæ•´çš„éƒ¨ç½²å’Œç®¡ç†è…³æœ¬
- âœ… **å¥åº·æª¢æŸ¥**ï¼šè‡ªå‹•ç›£æ§æœå‹™ç‹€æ…‹
- âœ… **å‚™ä»½é‚„åŸ**ï¼šè³‡æ–™åº«å‚™ä»½å’Œé‚„åŸåŠŸèƒ½

### æŠ€è¡“æ”¹é€²

- å‡ç´šåˆ° Next.js 16 å’Œ React 19
- ä½¿ç”¨ Tailwind CSS v4
- æ”¹é€²çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„
- å„ªåŒ–çš„è³‡æ–™åº«æŸ¥è©¢å’Œç´¢å¼•
- PM2 é€²ç¨‹ç®¡ç†
- å®Œæ•´çš„ TypeScript é¡å‹æ”¯æ´

## ğŸ”§ ç³»çµ±éœ€æ±‚

### æœ€ä½éœ€æ±‚
- CPU: 1 æ ¸å¿ƒ
- RAM: 2GB
- ç¡¬ç¢Ÿ: 5GB
- Node.js: 18.0.0+
- PostgreSQL: 14.0+

### æ¨è–¦é…ç½®
- CPU: 2 æ ¸å¿ƒ
- RAM: 4GB
- ç¡¬ç¢Ÿ: 20GB
- Node.js: 20.0.0+
- PostgreSQL: 15.0+

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

### é–‹ç™¼æµç¨‹

1. Fork æœ¬å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

### ä»£ç¢¼è¦ç¯„

- ä½¿ç”¨ TypeScriptï¼ˆå‰ç«¯ï¼‰
- éµå¾ª ESLint è¦å‰‡
- æ·»åŠ é©ç•¶çš„è¨»é‡‹
- æ›´æ–°ç›¸é—œæ–‡æª”

## ğŸ“ æˆæ¬Š

ISC License

## ğŸ’¬ æ”¯æ´

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼š

1. æŸ¥çœ‹ [æ•…éšœæ’é™¤æ–‡æª”](TROUBLESHOOTING.md)
2. æŸ¥çœ‹ [éƒ¨ç½²æŒ‡å—](DEPLOYMENT_GUIDE.md)
3. æäº¤ [Issue](https://github.com/956zs/discord-embed-app/issues
4. æŸ¥çœ‹æ—¥èªŒï¼š`./manage.sh logs`

## ğŸ™ è‡´è¬

- [Discord.js](https://discord.js.org/) - Discord API å°è£
- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [shadcn/ui](https://ui.shadcn.com/) - UI çµ„ä»¶åº«
- [Recharts](https://recharts.org/) - åœ–è¡¨åº«
- [PostgreSQL](https://www.postgresql.org/) - è³‡æ–™åº«
